!function r(c,o,s){function l(n,e){if(!o[n]){if(!c[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(u)return u(n,!0);var a=new Error("Cannot find module '"+n+"'");throw a.code="MODULE_NOT_FOUND",a}var i=o[n]={exports:{}};c[n][0].call(i.exports,function(e){return l(c[n][1][e]||e)},i,i.exports,r,c,o,s)}return o[n].exports}for(var u="function"==typeof require&&require,e=0;e<s.length;e++)l(s[e]);return l}({1:[function(l,e,n){"use strict";var u=l("./cache-manager"),t=window.fsUtils,d=t.fs,f=t.downloadFile,i=t.readText,r=t.readArrayBuffer,a=t.readJson,h=t.loadSubpackage,g=t.getUserDataPath,c=t.exists,m=/^https?:\/\/.*/,p=cc.assetManager.downloader,o=cc.assetManager.parser,s=cc.assetManager.presets;p.maxConcurrency=8,p.maxRequestsPerFrame=64,s.scene.maxConcurrency=10,s.scene.maxRequestsPerFrame=64;var _={},b=cc.sys;function v(e,n,t){m.test(e)?t&&t(new Error("Can not load remote scripts")):(b.platform!==b.Platform.TAOBAO_CREATIVE_APP&&l("../../../"+e),t&&t(null))}function y(t,e,a){cc.AudioPlayer.load(t).then(function(e){var n={player:e,url:t,duration:e.duration,type:e.type};a(null,n)}).catch(function(e){a(e)})}function w(a,n,i,e,r){var t=function(e,n){var t=!1,a=!1;if(e.startsWith(g()))t=!0;else if(m.test(e)){if(!n.reload){var i=u.cachedFiles.get(e);if(i)a=!0,e=i.url;else{var r=u.tempFiles.get(e);r&&(t=!0,e=r)}}}else t=!0;return{url:e,inLocal:t,inCache:a}}(a,i);t.inLocal?n(t.url,i,r):t.inCache?(u.updateLastTime(a),n(t.url,i,function(e,n){e&&u.removeCache(a),r(e,n)})):f(a,null,i.header,e,function(e,t){e?r(e,null):n(t,i,function(e,n){e||(u.tempFiles.add(a,t),u.cacheFile(a,t,i.cacheEnabled,i.__cacheBundleRoot__,!0)),r(e,n)})})}function E(e,n,t){r(e,t)}function F(e,n,t){i(e,t)}function x(e,n,t){a(e,t)}function C(e,n,t){w(e,x,n,n.onFileProgress,t)}function D(e,n,t){w(e,E,n,n.onFileProgress,t)}function M(e,n,t){t(null,__globalAdapter.loadFont(e)||"Arial")}function A(n,e,t){c(n,function(e){e?t(null,n):t(new Error("file ".concat(n," does not exist!")))})}function T(e,n,t){w(e,A,n,n.onFileProgress,t)}b.platform===b.Platform.BAIDU_MINI_GAME&&(l=__baiduRequire);function B(e,t,a){r(e,function(e,n){if(e)return a(e);S(n,t,a)})}function P(e,t,a){r(e,function(e,n){if(e)return a(e);O(n,t,a)})}function I(e,t,a){r(e,function(e,n){if(e)return a(e);j(n,t,a)})}function K(e,t,a){i(e,function(e,n){if(e)return a(e);N(n,t,a)})}var S=o.parsePVRTex,O=o.parsePKMTex,j=o.parseASTCTex,N=o.parsePlist;p.downloadScript=v,o.parsePVRTex=B,o.parsePKMTex=P,o.parseASTCTex=I,o.parsePlist=K,p.register({".js":v,".mp3":T,".ogg":T,".wav":T,".m4a":T,".png":T,".jpg":T,".bmp":T,".jpeg":T,".gif":T,".ico":T,".tiff":T,".image":T,".webp":T,".pvr":T,".pkm":T,".astc":T,".font":T,".eot":T,".ttf":T,".woff":T,".svg":T,".ttc":T,".ccon":function(i,e,a){C(i,e,function(e,n){if(e)a(e);else{var t=cc.internal.parseCCONJson(n);Promise.all(t.chunks.map(function(e){return new Promise(function(t,a){D("".concat(cc.path.mainFileName(i)).concat(e),{},function(e,n){e?a(e):t(new Uint8Array(n))})})})).then(function(e){var n=new cc.internal.CCON(t.document,e);a(null,n)}).catch(function(e){a(e)})}})},".cconb":function(e,n,a){D(e,n,function(e,n){if(e)a(e);else try{var t=cc.internal.decodeCCONBinary(new Uint8Array(n));a(null,t)}catch(e){a(e)}})},".txt":T,".xml":T,".vsh":T,".fsh":T,".atlas":T,".tmx":T,".tsx":T,".plist":T,".fnt":T,".json":C,".ExportJson":T,".binary":T,".bin":T,".dbbin":T,".skel":T,".mp4":T,".avi":T,".mov":T,".mpg":T,".mpeg":T,".rm":T,".rmvb":T,bundle:function(e,t,i){var a=cc.path.basename(e),n=t.version||cc.assetManager.downloader.bundleVers[a],r=n?n+".":"";if(_[a]){var c="subpackages/".concat(a,"/config.").concat(r,"json");h(a,t.onFileProgress,function(e){e?i(e,null):C(c,t,function(e,n){n&&(n.base="subpackages/".concat(a,"/")),i(e,n)})})}else{var o,s;m.test(e)||e.startsWith(g())?(s=e,o="src/bundle-scripts/".concat(a,"/index.").concat(r,"js"),u.makeBundleFolder(a)):-1!==p.remoteBundles.indexOf(a)?(s="".concat(p.remoteServerAddress,"remote/").concat(a),o="src/bundle-scripts/".concat(a,"/index.").concat(r,"js"),u.makeBundleFolder(a)):(s="assets/".concat(a),o="assets/".concat(a,"/index.").concat(r,"js")),b.platform!==b.Platform.TAOBAO_CREATIVE_APP&&l("./"+o),t.__cacheBundleRoot__=a,C(c="".concat(s,"/config.").concat(r,"json"),t,function(e,a){if(e)i&&i(e);else if(a.isZip){var n=a.zipVersion;!function(t,a,i){var e=u.cachedFiles.get(t);e?(u.updateLastTime(t),i&&i(null,e.url)):m.test(t)?f(t,null,a.header,a.onFileProgress,function(e,n){e?i&&i(e):u.unzipAndCacheBundle(t,n,a.__cacheBundleRoot__,i)}):u.unzipAndCacheBundle(t,t,a.__cacheBundleRoot__,i)}("".concat(s,"/res.").concat(n?n+".":"","zip"),t,function(e,n){if(e)i&&i(e);else{if(a.base=n+"/res/",b.platform===b.Platform.ALIPAY_MINI_GAME&&b.os===b.OS.ANDROID){var t=n+"res/";d.accessSync({path:t})&&(a.base=t)}i&&i(null,a)}})}else a.base=s+"/",i&&i(null,a)})}},default:function(e,n,t){w(e,F,n,n.onFileProgress,t)}}),o.register({".png":p.downloadDomImage,".jpg":p.downloadDomImage,".bmp":p.downloadDomImage,".jpeg":p.downloadDomImage,".gif":p.downloadDomImage,".ico":p.downloadDomImage,".tiff":p.downloadDomImage,".image":p.downloadDomImage,".webp":p.downloadDomImage,".pvr":B,".pkm":P,".astc":I,".font":M,".eot":M,".ttf":M,".woff":M,".svg":M,".ttc":M,".mp3":y,".ogg":y,".wav":y,".m4a":y,".txt":F,".xml":F,".vsh":F,".fsh":F,".atlas":F,".tmx":F,".tsx":F,".fnt":F,".plist":K,".binary":E,".bin":E,".dbbin":E,".skel":E,".ExportJson":x}),cc.assetManager.transformPipeline.append(function(e){for(var n=e.output=e.input,t=0,a=n.length;t<a;t++){var i=n[t],r=i.options;if(i.config)r.__cacheBundleRoot__=i.config.name;else{if("bundle"===i.ext)continue;r.cacheEnabled=void 0!==r.cacheEnabled&&r.cacheEnabled}".cconb"===i.ext?i.url=i.url.replace(i.ext,".bin"):".ccon"===i.ext&&(i.url=i.url.replace(i.ext,".json"))}});var R=cc.assetManager.init;cc.assetManager.init=function(e){R.call(cc.assetManager,e);var n=cc.settings.querySettings("assets","subpackages");n&&n.forEach(function(e){return _[e]="subpackages/"+e}),u.init()}},{"./cache-manager":3}],2:[function(e,n,t){"use strict";!function(){if(cc&&cc.internal&&cc.internal.EditBox){var t=cc.internal.EditBox,e=cc.js,a=t.KeyboardReturnType,i=null,r=null;e.extend(n,t._EditBoxImpl),t._EditBoxImpl=n,Object.assign(n.prototype,{init:function(e){e?this._delegate=e:cc.error("EditBox init failed")},beginEditing:function(){var n=this;this._editing||this._ensureKeyboardHide(function(){var e=n._delegate;n._showKeyboard(),n._registerKeyboardEvent(),n._editing=!0,r=n,e._editBoxEditingDidBegan()})},endEditing:function(){this._hideKeyboard();var e=this._eventListeners;e.onKeyboardComplete&&e.onKeyboardComplete()},_registerKeyboardEvent:function(){var t=this,a=this._delegate,e=this._eventListeners;e.onKeyboardInput=function(e){a._string!==e.value&&a._editBoxTextChanged(e.value)},e.onKeyboardConfirm=function(e){e&&e.value?a._editBoxEditingReturn(e.value):a._editBoxEditingReturn();var n=t._eventListeners;n.onKeyboardComplete&&n.onKeyboardComplete()},e.onKeyboardComplete=function(e){t._editing=!1,r=null,t._unregisterKeyboardEvent(),e&&e.value?a._editBoxEditingDidEnded(e.value):a._editBoxEditingDidEnded()},__globalAdapter.onKeyboardInput(e.onKeyboardInput),__globalAdapter.onKeyboardConfirm(e.onKeyboardConfirm),__globalAdapter.onKeyboardComplete(e.onKeyboardComplete)},_unregisterKeyboardEvent:function(){var e=this._eventListeners;e.onKeyboardInput&&(__globalAdapter.offKeyboardInput(e.onKeyboardInput),e.onKeyboardInput=null),e.onKeyboardConfirm&&(__globalAdapter.offKeyboardConfirm(e.onKeyboardConfirm),e.onKeyboardConfirm=null),e.onKeyboardComplete&&(__globalAdapter.offKeyboardComplete(e.onKeyboardComplete),e.onKeyboardComplete=null)},_otherEditing:function(){return!!r&&r!==this&&r._editing},_ensureKeyboardHide:function(e){var n=this._otherEditing();if(!n&&!i)return e();i&&clearTimeout(i),n&&r.endEditing(),i=setTimeout(function(){i=null,e()},600)},_showKeyboard:function(){var e=this._delegate,n=e.inputMode===t.InputMode.ANY;__globalAdapter.showKeyboard({defaultValue:e.string,maxLength:e.maxLength<0?65535:e.maxLength,multiple:n,confirmHold:!1,confirmType:function(e){switch(e){case a.DEFAULT:case a.DONE:return"done";case a.SEND:return"send";case a.SEARCH:return"search";case a.GO:return"go";case a.NEXT:return"next"}return"done"}(e.returnType),success:function(e){},fail:function(e){cc.warn(e.errMsg)}})},_hideKeyboard:function(){__globalAdapter.hideKeyboard({success:function(e){},fail:function(e){cc.warn(e.errMsg)}})}})}function n(){this._delegate=null,this._editing=!1,this._eventListeners={onKeyboardInput:null,onKeyboardConfirm:null,onKeyboardComplete:null}}}()},{}],3:[function(e,n,t){"use strict";var a=window.fsUtils,i=a.getUserDataPath,r=a.readJsonSync,o=a.makeDirSync,c=a.writeFileSync,u=a.copyFile,d=a.downloadFile,s=a.deleteFile,l=a.rmdirSync,f=a.unzip,h=a.isOutOfStorage,g=!1,m=null,p=!1,_=0,b=/^https?:\/\/.*/,v={cacheDir:"gamecaches",cachedFileName:"cacheList.json",cacheEnabled:!0,autoClear:!0,cacheInterval:500,deleteInterval:500,writeFileInterval:2e3,outOfStorage:!1,tempFiles:null,cachedFiles:null,cacheQueue:{},version:"1.0",getCache:function(e){return this.cachedFiles.has(e)?this.cachedFiles.get(e).url:""},getTemp:function(e){return this.tempFiles.has(e)?this.tempFiles.get(e):""},init:function(){this.cacheDir=i()+"/"+this.cacheDir;var e=this.cacheDir+"/"+this.cachedFileName,n=r(e);n instanceof Error||!n.version?(n instanceof Error||l(this.cacheDir,!0),this.cachedFiles=new cc.AssetManager.Cache,o(this.cacheDir,!0),c(e,JSON.stringify({files:this.cachedFiles._map,version:this.version}),"utf8")):this.cachedFiles=new cc.AssetManager.Cache(n.files),this.tempFiles=new cc.AssetManager.Cache},updateLastTime:function(e){this.cachedFiles.has(e)&&(this.cachedFiles.get(e).lastTime=Date.now())},_write:function(){m=null,c(this.cacheDir+"/"+this.cachedFileName,JSON.stringify({files:this.cachedFiles._map,version:this.version}),"utf8")},writeCacheFile:function(){m=m||setTimeout(this._write.bind(this),this.writeFileInterval)},_cache:function(){g=!1;var n=this,t="";for(var e in this.cacheQueue){t=e;break}if(t){var a=this.cacheQueue[t],i=a.srcUrl,r=a.isCopy,c=a.cacheBundleRoot,o=Date.now().toString(),s="";s=c?"".concat(this.cacheDir,"/").concat(c,"/").concat(o).concat(_++).concat(cc.path.extname(t)):"".concat(this.cacheDir,"/").concat(o).concat(_++).concat(cc.path.extname(t)),r?u(i,s,l):d(i,s,null,l)}function l(e){if(e){if(h(e.message))return n.outOfStorage=!0,void(n.autoClear&&n.clearLRU())}else n.cachedFiles.add(t,{bundle:c,url:s,lastTime:o}),n.writeCacheFile();delete n.cacheQueue[t],cc.js.isEmptyObject(n.cacheQueue)||g||(g=!0,setTimeout(n._cache.bind(n),n.cacheInterval))}},cacheFile:function(e,n,t,a,i){!(t=void 0!==t?t:this.cacheEnabled)||this.cacheQueue[e]||this.cachedFiles.has(e)||(this.cacheQueue[e]={srcUrl:n,cacheBundleRoot:a,isCopy:i},g||this.outOfStorage||(g=!0,setTimeout(this._cache.bind(this),this.cacheInterval)))},clearCache:function(){var n=this;l(this.cacheDir,!0),this.cachedFiles=new cc.AssetManager.Cache,o(this.cacheDir,!0),this.outOfStorage=!1,clearTimeout(m),this._write(),cc.assetManager.bundles.forEach(function(e){b.test(e.base)&&n.makeBundleFolder(e.name)})},clearLRU:function(){if(!p){p=!0;var t=[],a=this;if(this.cachedFiles.forEach(function(n,e){a._isZipFile(e)&&cc.assetManager.bundles.find(function(e){return-1!==e.base.indexOf(n.url)})||t.push({originUrl:e,url:n.url,lastTime:n.lastTime})}),t.sort(function(e,n){return e.lastTime-n.lastTime}),t.length=Math.floor(t.length/3),0!==t.length){for(var e=0,n=t.length;e<n;e++)this.cachedFiles.remove(t[e].originUrl);clearTimeout(m),this._write(),setTimeout(function e(){var n=t.pop();a._isZipFile(n.originUrl)?(l(n.url,!0),a._deleteFileCB()):s(n.url,a._deleteFileCB.bind(a)),0<t.length?setTimeout(e,a.deleteInterval):p=!1},a.deleteInterval)}}},removeCache:function(e){if(this.cachedFiles.has(e)){var n=this.cachedFiles.remove(e).url;clearTimeout(m),this._write(),this._isZipFile(e)?(l(n,!0),this._deleteFileCB()):s(n,this._deleteFileCB.bind(this))}},_deleteFileCB:function(e){e||(this.outOfStorage=!1)},makeBundleFolder:function(e){o(this.cacheDir+"/"+e,!0)},unzipAndCacheBundle:function(n,e,t,a){var i=Date.now().toString(),r="".concat(this.cacheDir,"/").concat(t,"/").concat(i).concat(_++),c=this;o(r,!0),f(e,r,function(e){if(e)return l(r,!0),h(e.message)&&(c.outOfStorage=!0,c.autoClear&&c.clearLRU()),void(a&&a(e));c.cachedFiles.add(n,{bundle:t,url:r,lastTime:i}),c.writeCacheFile(),a&&a(null,r)})},_isZipFile:function(e){return".zip"===e.slice(-4)}};cc.assetManager.cacheManager=n.exports=v},{}],4:[function(e,n,t){"use strict";e("./Editbox"),e("./AssetManager"),e("./misc")},{"./AssetManager":1,"./Editbox":2,"./misc":5}],5:[function(e,n,t){"use strict";cc.macro.DOWNLOAD_MAX_CONCURRENT=10},{}],6:[function(e,n,t){"use strict";var a=cc.assetManager.parser,i=cc.assetManager.downloader,r=cc.debug;function c(e,n,t){t(null,e)}function o(e,n,t){var a=window.screencanvas.createImage();return a.onload=function(){a.onload=null,a.onerror=null,t&&t(null,a)},a.onerror=function(){a.onload=null,a.onerror=null,t&&t(new Error(r.getError(4930,e)))},a.src=e,a}my.isIDE&&i.register({".png":c,".jpg":c,".bmp":c,".jpeg":c,".gif":c,".ico":c,".tiff":c,".image":c,".webp":c}),i.register({".mp3":c,".ogg":c,".wav":c,".m4a":c}),i.downloadDomImage=o,a.register({".png":o,".jpg":o,".bmp":o,".jpeg":o,".gif":o,".ico":o,".tiff":o,".image":o,".webp":o})},{}],7:[function(e,n,t){"use strict";!function(){if(cc&&cc.internal&&cc.internal.EditBox){var n=cc.internal.EditBox,e=cc.js,r=n.KeyboardReturnType,t=n._EditBoxImpl;e.extend(a,t),n._EditBoxImpl=a,Object.assign(a.prototype,{init:function(e){e?this._delegate=e:cc.error("EditBox init failed")},beginEditing:function(){if(!this._editing){var e=this._delegate;this._showPrompt(),this._editing=!0,e._editBoxEditingDidBegan()}},endEditing:function(){cc.warn("Can't support to end editing.")},_showPrompt:function(){var t=this,a=this._delegate,e=a.inputMode===n.InputMode.ANY,i=a.maxLength<0?65535:a.maxLength;e&&cc.warn("Multiline editing is not supported"),my.prompt({title:"",message:a.placeholder,okButtonText:function(e){switch(e){case r.DEFAULT:case r.DONE:return"done";case r.SEND:return"send";case r.SEARCH:return"search";case r.GO:return"go";case r.NEXT:return"next"}return"done"}(a.returnType),cancelButtonText:"cancel",success:function(e){if(e.ok){var n=e.inputValue;n=i<=n.length?n.substring(0,i):n,a._string!==n&&a._editBoxTextChanged(n),a._editBoxEditingReturn()}t._editing=!1,a._editBoxEditingDidEnded()}})}})}function a(){t.call(this)}}()},{}],8:[function(e,n,t){"use strict";if(cc&&cc.LabelComponent){var a=cc.LabelComponent,i=my.createOffscreenCanvas(),r=i.getContext("2d"),c={canvas:i,context:r};cc.game.on(cc.game.EVENT_ENGINE_INITED,function(){Object.assign(a._canvasPool,{get:function(){return c},put:function(){}})})}},{}],9:[function(e,n,t){"use strict";e("../fs-utils"),e("../../../../common/engine/index"),e("./AssetManager.js"),e("./Label.js"),e("./Editbox.js")},{"../../../../common/engine/index":4,"../fs-utils":10,"./AssetManager.js":6,"./Editbox.js":7,"./Label.js":8}],10:[function(e,n,t){"use strict";var i=my.getFileSystemManager?my.getFileSystemManager():null,a=/the maximum size of the file storage/,o={fs:i,isOutOfStorage:function(e){return a.test(e)},getUserDataPath:function(){return my.env.USER_DATA_PATH},checkFsValid:function(){return!!i||(console.warn("Can not get the file system!"),!1)},deleteFile:function(n,t){i.unlink({filePath:n,success:function(){t&&t(null)},fail:function(e){console.warn("Delete file failed: path: ".concat(n," message: ").concat(e.errorMessage)),t&&t(new Error(e.errorMessage))}})},downloadFile:function(n,t,e,a,i){var r={url:n,success:function(e){t?o.copyFile(e.apFilePath,t,i):i&&i(null,e.apFilePath)},fail:function(e){console.warn("Download file failed: path: ".concat(n," message: ").concat(e.errorMessage)),i&&i(new Error(e.errorMessage),null)}};e&&(r.header=e);var c=my.downloadFile(r);a&&c.onProgressUpdate(a)},saveFile:function(e,n,t){o.copyFile(e,n,t)},copyFile:function(n,e,t){i.copyFile({srcPath:n,destPath:e,success:function(){t&&t(null)},fail:function(e){console.warn("Copy file failed: path: ".concat(n," message: ").concat(e.errorMessage)),t&&t(new Error(e.errorMessage))}})},writeFile:function(n,e,t,a){i.writeFile({filePath:n,encoding:t,data:e,success:function(){a&&a(null)},fail:function(e){console.warn("Write file failed: path: ".concat(n," message: ").concat(e.errorMessage)),a&&a(new Error(e.errorMessage))}})},writeFileSync:function(n,e,t){try{return i.writeFileSync({filePath:n,data:e,encoding:t}),null}catch(e){return console.warn("Write file failed: path: ".concat(n," message: ").concat(e.message)),new Error(e.message)}},readFile:function(n,e,t){i.readFile({filePath:n,encoding:e,success:function(e){t&&t(null,e.data)},fail:function(e){console.warn("Read file failed: path: ".concat(n," message: ").concat(e.errorMessage)),t&&t(new Error(e.errorMessage),null)}})},readDir:function(n,t){i.readdir({dirPath:n,success:function(e){t&&t(null,e.files)},fail:function(e){console.warn("Read directory failed: path: ".concat(n," message: ").concat(e.errorMessage)),t&&t(new Error(e.errorMessage),null)}})},readText:function(e,n){o.readFile(e,"utf8",n)},readArrayBuffer:function(e,n){o.readFile(e,"",n)},readJson:function(a,i){o.readFile(a,"utf8",function(n,e){var t=null;if(!n)try{t=JSON.parse(e)}catch(e){console.warn("Read json failed: path: ".concat(a," message: ").concat(e.message)),n=new Error(e.message)}i&&i(n,t)})},readJsonSync:function(n){try{var e=i.readFileSync({filePath:n,encoding:"utf8"});return JSON.parse(e.data)}catch(e){return console.warn("Read json failed: path: ".concat(n," message: ").concat(e.message)),new Error(e.message)}},makeDirSync:function(n,e){try{return i.mkdirSync({dirPath:n,recursive:e}),null}catch(e){return console.warn("Make directory failed: path: ".concat(n," message: ").concat(e.message)),new Error(e.message)}},rmdirSync:function(n,e){try{i.rmdirSync({dirPath:n,recursive:e})}catch(e){return console.warn("rm directory failed: path: ".concat(n," message: ").concat(e.message)),new Error(e.message)}},exists:function(e,n){i.readFile({filePath:e,success:function(){n&&n(!0)},fail:function(){n&&n(!1)}})},loadSubpackage:function(e,n,t){throw new Error("Not Implemented")},unzip:function(n,e,t){i.unzip({zipFilePath:n,targetPath:e,success:function(){t&&t(null)},fail:function(e){console.warn("unzip failed: path: ".concat(n," message: ").concat(e.errorMessage)),t&&t(new Error("unzip failed: ".concat(e.errorMessage)))}})}};window.fsUtils=n.exports=o},{}]},{},[9]);